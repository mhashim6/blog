<!doctype html><html prefix="og: https://ogp.me/ns#" lang=en data-theme=light><head><meta charset=utf-8><title itemprop=name>Microsoft Vulnerability: Sharepoint Content Disclosure :: The Upside-Down Trees</title><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Amiri&family=Montserrat&display=swap" rel=stylesheet><meta property="og:title" content="Microsoft Vulnerability: Sharepoint Content Disclosure | The Upside-Down Trees"><meta name=twitter:card content="summary_large_image"><meta name=twitter:title content="Microsoft Vulnerability: Sharepoint Content Disclosure | The Upside-Down Trees"><meta itemprop=name content="Microsoft Vulnerability: Sharepoint Content Disclosure | The Upside-Down Trees"><meta name=application-name content="Microsoft Vulnerability: Sharepoint Content Disclosure | The Upside-Down Trees"><meta property="og:site_name" content="blog.mhashim6.me"><meta name=description content="Recently, I came across a vulnerability in Microsoft Sharepoint that allowed bypassing video content download permissions. In this post, I will share the details of the vulnerability, the reproduction process and steps, and how Microsoft’s MSRC handled my report."><meta itemprop=description content="Recently, I came across a vulnerability in Microsoft Sharepoint that allowed bypassing video content download permissions. In this post, I will share the details of the vulnerability, the reproduction process and steps, and how Microsoft’s MSRC handled my report."><meta property="og:description" content="Recently, I came across a vulnerability in Microsoft Sharepoint that allowed bypassing video content download permissions. In this post, I will share the details of the vulnerability, the reproduction process and steps, and how Microsoft’s MSRC handled my report."><meta name=twitter:description content="Recently, I came across a vulnerability in Microsoft Sharepoint that allowed bypassing video content download permissions. In this post, I will share the details of the vulnerability, the reproduction process and steps, and how Microsoft’s MSRC handled my report."><base href=https://blog.mhashim6.me/microsoft-vulnerability-sharepoint-content-disclosure/><link rel=canonical href=https://blog.mhashim6.me/microsoft-vulnerability-sharepoint-content-disclosure/ itemprop=url><meta name=url content="https://blog.mhashim6.me/microsoft-vulnerability-sharepoint-content-disclosure/"><meta name=twitter:url content="https://blog.mhashim6.me/microsoft-vulnerability-sharepoint-content-disclosure/"><meta property="og:url" content="https://blog.mhashim6.me/microsoft-vulnerability-sharepoint-content-disclosure/"><meta property="og:locale" content="en"><meta name=language content="English"><meta itemprop=image content="https://blog.mhashim6.me/images/ms-sharepoint-vulnerability.jpeg"><meta property="og:image" content="https://blog.mhashim6.me/images/ms-sharepoint-vulnerability.jpeg"><meta property="og:updated_time" content="111111-22-120T00:00:00Z"><link rel=sitemap type=application/xml title=Sitemap href=https://blog.mhashim6.mesitemap.xml><meta name=robots content="index,follow"><meta name=googlebot content="index,follow"><meta name=twitter:site content><meta name=twitter:creator content="@UpsideDownTrees"><link rel=apple-touch-icon sizes=180x180 href=https://blog.mhashim6.me/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://blog.mhashim6.me/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://blog.mhashim6.me/favicon-16x16.png><link rel="shortcut icon" href=https://blog.mhashim6.me/favicon.ico><link rel=icon type=image/x-icon sizes="16x16 32x32" href=https://blog.mhashim6.me/favicon.ico><link rel=manifest href=https://blog.mhashim6.me/site.webmanifest><meta name=color-scheme content="light dark"><meta name=theme-color media="(prefers-color-scheme: light)" content="#EDE3D9"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#17191C"><link rel=author href=https://blog.mhashim6.me/humans.txt><script type=application/ld+json>{"@context":"https://schema.org","@type":"Organization","name":"UpsideDownTrees","url":"https://blog.mhashim6.me","sameAs":["https://mhashim6.me","https://linkedin.com/in/mhashim6","https://github.com/mhashim6"]}</script><script>const storage=localStorage.getItem("dark-mode");("dark"===storage||!storage&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches)&&document.documentElement.setAttribute("data-theme","dark")</script><script src=https://blog.mhashim6.me/js/darkm.min.1be248604351b865213d07e5a761998a21e20d82ba86c4fe72cddc853f108b7d.js></script>
<link rel=stylesheet href=https://blog.mhashim6.me/css/style.min.35968471b7890ab7126db15dfbd7570a8412c6c4c3c736004dbe08d9bbcd02f0.css><link rel=stylesheet href=css/synatx.css><script defer data-domain=blog.mhashim6.me src=https://plausible.io/js/script.js></script></head><body class=single><header class=site-header><link rel=alternate type=application/rss+xml href=https://blog.mhashim6.me/index.xml title="The Upside-Down Trees"><div class=inner><p class="site-title slide-horizontal-invert"><a href=https://blog.mhashim6.me/>UpsideDownTrees</a></p><input type=checkbox id=check-menu class=check-menu hidden>
<label for=check-menu class="nav-btn hide-desktop" aria-label="Open/close menu"><span class=lines></span></label><nav class="site-nav hide-mobile slide-horizontal"><button class="theme__btn light--hidden" aria-label="Enable light mode"><svg aria-hidden="true" viewBox="0 0 24 24" id="sun"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button>
<button class="theme__btn dark--hidden" aria-label="Enable dark mode"><svg aria-hidden="true" viewBox="0 0 24 24" id="moon"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg></button><ul class=site-menu><li><a target=_blank href=https://t.me/UpsideDownTrees><span>Telegram</span></a></li><li><a target=_blank href=https://mhashim6.me><span>About me?</span></a></li><li><a href=https://blog.mhashim6.me/index.xml><span>RSS</span></a></li><li><a href=https://blog.mhashim6.me/posts/><span>Archive</span></a></li></ul></nav></div></header><main class=site-main><article><header class=subheader style=background-image:url(/images/ms-sharepoint-vulnerability.jpeg)><div class="title-container slide-invert"><h1 class=post-title>Microsoft Vulnerability: Sharepoint Content Disclosure</h1><figcaption><i></i></figcaption><div><div class=taxonomy><a class="chip no-decor" href=https://blog.mhashim6.me/tags/security>Security</a>
<a class="chip no-decor" href=https://blog.mhashim6.me/tags/microsoft>Microsoft</a>
<a class="chip no-decor" href=https://blog.mhashim6.me/tags/vulnerability>Vulnerability</a>
<a class="chip no-decor" href=https://blog.mhashim6.me/tags/sharepoint>Sharepoint</a></div></div></div></header><div class="content slide-invert"><div dir=ltr><h2 id=introduction>Introduction</h2><p>In this post, I will detail my experience discovering and reporting a content disclosure vulnerability in <a href=https://learn.microsoft.com/en-us/stream/streamnew/overview>Microsoft Sharepoint Stream</a>.</p><p>The vulnerability allowed unauthorized access to video content by bypassing download restriction permissions. I&rsquo;ll share the technical details, impact, and Microsoft&rsquo;s response while adhering to responsible disclosure practices.</p><h2 id=discovery--research-process>Discovery & Research Process</h2><blockquote><p>In other words, the company&rsquo;s internal video is actually Public!</p></blockquote><p>I was preparing some material for an internal GenAI training session when I stumbled upon the vulnerability. I was watching a previously recorded video call that was shared with me by one of my teammates on our internal Sharepoint Stream.</p><p>During my research, I wondered if Sharepoint&rsquo;s video download permissions (<em>Which I didn&rsquo;t have</em>) could be bypassed, allowing unauthorized offline access to the content.</p><p>Curious, I started inspecting the video player&rsquo;s network requests and found that the video content was being streamed from a URL pointing to a unencrypted <a href=https://api.video/what-is/video-manifest/>video manifest file</a> that was accessible without any authentication. I was able to stream the video by directly accessing the URL on Safari, <strong>in an incognito session, and on a different device</strong>. In other words, the company&rsquo;s internal video is actually Public!</p><p><img src=https://blog.mhashim6.me/images/ms-incognito.jpeg alt="Internal Stream video playing on Safari&amp;rsquo;s incognito mode (aka Private mode)" title="Internal Stream video playing on Safari's incognito mode (aka Private mode)"></p><p>Consequently, I was able to download the video content by using a simple combination of <code>curl</code> and <a href=https://www.ffmpeg.org/><code>ffmpeg</code></a>. I was able to reproduce the issue multiple times, and I was able to download the video content without any restrictions.</p><video controls loop=true>
<source src=https://blog.mhashim6.me/videos/ms-poc.mp4></video><p>I went to <a href=https://www.linkedin.com/in/tarrinho/><strong>Pedro Tarrinho</strong></a>, our <s>resident Security Lord and Saviour</s> Head of Application Security in Celfocus, to discuss the issue and get his opinion. He suggested I report it to Microsoft&rsquo;s MSRC.</p><h2 id=not-very-technical-details>(Not very) Technical Details</h2><blockquote><p>Sharepoint&rsquo;s video manifests are very similar to that of Karl Marx&rsquo;s: open and accessible to all.</p></blockquote><h3 id=video-manifest-file>Video Manifest File</h3><p>Most websites try to offer a &ldquo;smart&rdquo; streaming service to serve videos in multiple resolutions and bitrates. This is done by providing a manifest file that contains the video&rsquo;s metadata and the URLs to the video chunks. The video player then requests these chunks and stitches them together to play the video.</p><p>An <a href=https://api.video/what-is/video-manifest/>example</a> of such file(s) is the <code>m3u8</code> format, which is a playlist file used by various video players to play video content. The file contains a list of video chunks, their duration, and the URL to the video content:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>#EXT-X-STREAM-INF:PROGRAM-ID=1,BANDWIDTH=4400000,RESOLUTION=3840x2160, CODECS=&#34;avc1.42e030,mp4a.40.2&#34;
</span></span><span class=line><span class=cl>/processing_video/2160/manifest.m3u8
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>#EXTM3U
</span></span><span class=line><span class=cl>#EXT-X-VERSION:3
</span></span><span class=line><span class=cl>#EXT-X-ALLOW-CACHE:NO
</span></span><span class=line><span class=cl>#EXT-X-TARGETDURATION:4
</span></span><span class=line><span class=cl>#EXT-X-MEDIA-SEQUENCE:0
</span></span><span class=line><span class=cl>#EXT-X-PLAYLIST-TYPE:VOD
</span></span><span class=line><span class=cl>#EXT-X-KEY:METHOD=AES-128,URI=&#34;aes.key&#34;,IV=0x07B1D7401B75CA2937353EC4550FEE5D
</span></span><span class=line><span class=cl>#EXTINF:4.000000,
</span></span><span class=line><span class=cl>0000.ts
</span></span><span class=line><span class=cl>#EXTINF:4.000000,
</span></span><span class=line><span class=cl>0001.ts
</span></span><span class=line><span class=cl>#EXTINF:4.000000,
</span></span><span class=line><span class=cl>0002.ts
</span></span><span class=line><span class=cl>#EXTINF:4.000000,
</span></span><span class=line><span class=cl>0003.ts
</span></span><span class=line><span class=cl>#EXTINF:4.000000,
</span></span><span class=line><span class=cl>0004.ts
</span></span><span class=line><span class=cl>#EXTINF:0.120000,
</span></span><span class=line><span class=cl>0005.ts
</span></span><span class=line><span class=cl>#EXT-X-ENDLIST
</span></span></code></pre></div><h3 id=manifest-security-or-lack-thereof>Manifest Security (or lack thereof)</h3><p>While secure manifest files require authentication and encryption, Sharepoint&rsquo;s video manifests are very similar to that of Karl Marx&rsquo;s: open and accessible to all.</p><p>Some manifest files can include encryption keys and require authentication tokens, Google even has a <a href=https://patents.google.com/patent/US11039181B1/en>patent</a> on the topic (<em>of course they do</em>). This ensures that only authorized users can access the video content. And let&rsquo;s not forget the most polarising technique: <a href=https://en.wikipedia.org/wiki/Digital_rights_management>DRM</a>.</p><h2 id=msrc-report--response>MSRC Report & Response</h2><blockquote><p><strong>it&rsquo;s dangerous to ignore the fact an insider without access to download permissions could exploit this vulnerability.</strong></p></blockquote><p>Following Pedro&rsquo;s advice, I reported the vulnerability to Microsoft&rsquo;s MSRC. I provided a detailed report of the vulnerability, including the steps to reproduce it, the impact, and the potential risks. I also included a video demonstration of the vulnerability in action.</p><p>However, Microsoft&rsquo;s response was somewhat expected. They acknowledged the report but stated that the issue was &ldquo;low severity&rdquo; and that they would not be fixing it. They also mentioned that the issue was not eligible for a bounty reward.</p><blockquote><p>&ldquo;We have shared your report with the team responsible for maintaining the product or service and they will consider a potential future fix, taking the appropriate action as needed to help keep customers protected.&rdquo;<br>– Microsoft MSRC</p></blockquote><p><strong>What I disagree with</strong> was another statement they made: <em>&ldquo;this requires a malicious insider.&rdquo;</em> While this is true in a sense, it&rsquo;s dangerous to ignore the fact an insider without access to download permissions could exploit this vulnerability.</p><h2 id=conclusion>Conclusion</h2><p>The issue was reported to Microsoft&rsquo;s MSRC, who acknowledged the report but deemed it &ldquo;low severity&rdquo; and ineligible for a bounty reward. The vulnerability remains unpatched, and the potential risks of exploitation are still present.</p><p>I hope this post sheds light on the importance of responsible disclosure practices and the need for companies to take security vulnerabilities seriously, regardless of their perceived severity.</p></div><button onclick='(()=>{navigator.share({url:"https://blog.mhashim6.me/microsoft-vulnerability-sharepoint-content-disclosure/"})})()'>
Share This Post <img src=https://img.icons8.com/ios-glyphs/22/17191C/share-rounded.png></button><div class=taxonomy><a class="chip category" href=https://blog.mhashim6.me/categories/pondering>Pondering</a>
<a class="chip category" href=https://blog.mhashim6.me/categories/tech>Tech</a>
<a class="chip category" href=https://blog.mhashim6.me/categories/reverse-engineering>Reverse Engineering</a></div><script id=telegram_comments async src=https://comments.app/js/widget.js?3 data-comments-app-website=b14MWwEx data-limit=1000 data-page-id=https://blog.mhashim6.me/microsoft-vulnerability-sharepoint-content-disclosure/ data-color=ceaa37 data-colorful=1 dark=0></script></div></article></main><footer class=site-footer><p class=copyright>© 2025 The Upside-Down Trees</p><ul class=social-links><li><a target=_blank class='icon icon-website' href=https://mhashim6.me aria-label="Follow on Website"></a></li><li><a target=_blank class='icon icon-linkedin' href=https://www.linkedin.com/in/mhashim6/ aria-label="Follow on LinkedIn"></a></li><li><a target=_blank class='icon icon-github' href=https://github.com/mhashim6 aria-label="Follow on GitHub"></a></li><li><a target=_blank class='icon icon-telegram' href=https://t.me/mhashim6 aria-label="Follow on Telegram"></a></li><li><a target=_blank class='icon icon-email' href=mailto:msg@mhashim6.me aria-label="Follow on Email"></a></li></ul></footer><script src=https://blog.mhashim6.me/js/prefixfree.min.9cea59c2cb403a83a6549aadada301521cf8b59b1abc0498e0a10432d186bd67.js></script></body></html>